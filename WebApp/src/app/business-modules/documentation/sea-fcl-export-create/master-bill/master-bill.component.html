<!--begin:: m-portlet-->
<div class="m-portlet">
    <div class="m-portlet__body">
        <!--begin::Form-->
        <div class="m-form m-form--state" *ngIf="formAddEdit">
            <div class="row">
                <div class="col-lg-4">
                    <div class="form-group" [ngClass]="{ 'm-form__group has-danger': formAddEdit.submitted && jobId.invalid }">
                        <label class="form-control-label" for="">
                            Job ID
                        </label>
                        <input type="text" #jobId="ngModel" class="form-control m-input m-input--square" placeholder="" disabled [(ngModel)]="shipment.jobNo" required>
                        <div class="form-control-feedback" *ngIf="formAddEdit.submitted && jobId.invalid" >
                            Code is required least 3 characters
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="form-group" [ngClass]="{ 'm-form__group has-danger': formAddEdit.submitted && estimatedTimeofDepature.invalid }">
                        <label class="form-control-label" for="">
                            Estimated time of departure <span class="m--font-danger">(*)</span>
                        </label>
                        <div class="m-input-icon m-input-icon--right down daterange-rtl">
                            <input type="text" class="form-control m-input m-input--square" #estimatedTimeofDepature="ngModel"
                                ngxDaterangepickerMd [locale]="{applyLabel: 'apply', format: 'DD/MM/YYYY'}"
                                [(ngModel)]="shipment.etdSelected"
                                [ranges]="ranges"
                                [alwaysShowCalendars]="true"
                                [singleDatePicker]="true"
                                name="estimatedTimeofDepature"
                                placeholder="dd/mm/yyyy"
                                [autoApply]="true"
                                required readonly/>
                            <span class="m-input-icon__icon m-input-icon__icon--right">
                                <span>
                                    <i class="la la-calendar"></i>
                                </span>
                            </span>
                            <div class="form-control-feedback" *ngIf="formAddEdit.submitted && estimatedTimeofDepature.invalid" >
                                Estimated time of departure is required
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="form-group"  [ngClass]="{ 'm-form__group has-danger': formAddEdit.submitted && (shipment.etaSelected!= null && shipment.etdSelected.startDate >= shipment.etaSelected.startDate) }">
                        <label class="form-control-label" for="">
                            Estimated time of Arrival
                        </label>
                        <div class="m-input-icon m-input-icon--right down daterange-rtl">
                            <input type="text" class="form-control m-input m-input--square"
                                ngxDaterangepickerMd [locale]="{applyLabel: 'apply', format: 'DD/MM/YYYY'}"
                                [(ngModel)]="shipment.etaSelected"
                                [ranges]="ranges"
                                [alwaysShowCalendars]="true"
                                [singleDatePicker]="true"
                                [autoApply]="true"
                                name="estimatedTimeofArrived"
                                placeholder="dd/mm/yyyy" 
                                readonly/>
                            <span class="m-input-icon__icon m-input-icon__icon--right">
                                <span>
                                    <i class="la la-calendar"></i>
                                </span>
                            </span>
                            <div class="form-control-feedback" *ngIf="formAddEdit.submitted && (shipment.etaSelected!= null && shipment.etdSelected.startDate >= shipment.etaSelected.startDate)" >
                                Estimated time of Arrival must more or equal estimated time of departure
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-4">
                    <div class="form-group" [ngClass]="{ 'm-form__group has-danger': formAddEdit.submitted && mblno.invalid }">
                        <label class="form-control-label" for="">
                            Master bill of lading no <span class="m--font-danger">(*)</span>
                        </label>
                        <input type="text" class="form-control m-input m-input--square" placeholder="Enter master bill of lading no" autocomplete="nope" 
                            (change)="shipment.mawb = shipment.mawb.trim()" [(ngModel)]="shipment.mawb" #mblno="ngModel" required>
                        <div class="form-control-feedback" *ngIf="formAddEdit.submitted && mblno.invalid" >
                            Master bill of lading no is required least 3 characters
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="form-group" [ngClass]="{ 'm-form__group has-danger': formAddEdit.submitted && shipment.mbltype == null }">
                        <label class="form-control-label" for="">
                                Master bill of lading type <span class="m--font-danger">(*)</span>
                        </label>
                        <ng-select [allowClear]="true" [items]="billOfLadingTypes" [disabled]="disabled" (data)="refreshValue($event)"
                            (selected)="shipment.mbltype = $event.id" (removed)="shipment.mbltype = null" (typed)="typed($event)"
                            placeholder="Select option">
                        </ng-select>
                        <div class="form-control-feedback" *ngIf="formAddEdit.submitted && shipment.mbltype == null" >
                            Master bill of lading type is required
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="form-group">
                        <label class="form-control-label" for="">
                                Supplier/Vendor (co-loader)
                        </label>
                        <!-- <ng-select [allowClear]="true" [items]="items" [disabled]="disabled" (data)="refreshValue($event)"
                            (selected)="selected($event)" (removed)="removed($event)" (typed)="typed($event)"
                            placeholder="Select option">
                        </ng-select> -->
                        <div class="dropdown e--combogrid" #selectedColoader>
                            <input class="form-control m-input m-input--square dropdown-toggle" type="text" readonly data-toggle="dropdown" placeholder="combogrid" 
                                [value]="selectedColoader.value == null?'Please selected coloader':selectedColoader.value">
                            <div class="dropdown-menu e--combogrid-content">
                                <div class="tabel-wrapper table-fixed">
                                    <div class="table-head-fixed">
                                        <div class="table-filter-block">
                                            <div class="search-field">
                                                <input class="form-control m-input m-input--square" type="text" placeholder="Search..." (keyup)="changeColoader($event.target.value)">
                                                <i class="icon-search"></i>
                                            </div>
                                        </div>
                                        <div class="table-header">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th class="col-xs-3">Partner ID</th>
                                                        <th class="col-xs-3">Name ABBR</th>
                                                        <th class="col-xs-3">Name EN</th>
                                                        <th class="col-xs-3">Tax Code</th>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="table-body-scroll">
                                        <table class="table table-hover" *ngIf="coloaders">
                                            <tbody *ngFor="let coloader of coloaders;let i = index;">
                                                <tr class="data-row" [ngClass]="{ 'data-selected': shipment.coloaderId!==null && shipment.coloaderId===coloader.id }" data-id="{{i}}" (click)="shipment.coloaderId = coloader.id; selectedColoader.value=coloader.partnerNameEn">
                                                    <td class="col-xs-3">{{ coloader.accountNo }}</td>
                                                    <td class="col-xs-3">{{ coloader.shortName }}</td>
                                                    <td class="col-xs-3">{{ coloader.partnerNameEn }}</td>
                                                    <td class="col-xs-3">{{ coloader.taxCode }}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-4">
                    <div class="form-group">
                        <label class="form-control-label" for="">
                            Booking no
                        </label>
                        <input type="text" class="form-control m-input m-input--square" placeholder="Enter text" autocomplete="nope"
                            (change)="shipment.bookingNo = shipment.bookingNo.trim()" [(ngModel)]="shipment.bookingNo">
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="form-group" [ngClass]="{ 'm-form__group has-danger': formAddEdit.submitted && shipment.typeOfService == null }">
                        <label class="form-control-label" for="">
                            Services type <span class="m--font-danger">(*)</span>
                        </label>
                        <ng-select [allowClear]="true" [items]="serviceTypes" [disabled]="disabled" (data)="refreshValue($event)"
                            (selected)="shipment.typeOfService = $event.id" (removed)="shipment.typeOfService = null" (typed)="typed($event)"
                            placeholder="Select service type">
                        </ng-select>
                        <div class="form-control-feedback" *ngIf="formAddEdit.submitted && shipment.typeOfService == null" >
                            Services type is required
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="form-group">
                        <label class="form-control-label" for="">
                            Aggent
                        </label>
                        <div class="dropdown e--combogrid" #selectedAgent>
                            <input class="form-control m-input m-input--square dropdown-toggle" type="text" readonly data-toggle="dropdown" placeholder="combogrid" 
                                [value]="selectedAgent.value == null?'Please selected agent':selectedAgent.value">
                            <div class="dropdown-menu e--combogrid-content">
                                <div class="tabel-wrapper table-fixed">
                                    <div class="table-head-fixed">
                                        <div class="table-filter-block">
                                            <div class="search-field">
                                                <input class="form-control m-input m-input--square" type="text" placeholder="Search..." (keyup)="changeAgent($event.target.value)">
                                                <i class="icon-search"></i>
                                            </div>
                                        </div>
                                        <div class="table-header">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th class="col-xs-3">Partner ID</th>
                                                        <th class="col-xs-3">Name ABBR</th>
                                                        <th class="col-xs-3">Name EN</th>
                                                        <th class="col-xs-3">Tax Code</th>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="table-body-scroll">
                                        <table class="table table-hover" *ngIf="agents">
                                            <tbody *ngFor="let agent of agents;let i = index;">
                                                <tr class="data-row" [ngClass]="{ 'data-selected': shipment.agentId!==null && shipment.agentId===agent.id }" data-id="{{i}}" 
                                                    (click)="shipment.agentId = agent.id; selectedAgent.value=agent.partnerNameEn">
                                                    <td class="col-xs-3">{{ agent.accountNo }}</td>
                                                    <td class="col-xs-3">{{ agent.shortName }}</td>
                                                    <td class="col-xs-3">{{ agent.partnerNameEn }}</td>
                                                    <td class="col-xs-3">{{ agent.taxCode }}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-4">
                    <div class="form-group" [ngClass]="{ 'm-form__group has-danger': formAddEdit.submitted && shipment.pol == null }">
                        <label class="form-control-label" for="">
                            Port of loading <span class="m--font-danger">(*)</span>
                        </label>
                        <div class="dropdown e--combogrid" #selectedPOL>
                            <input class="form-control m-input m-input--square dropdown-toggle" type="text" readonly data-toggle="dropdown" placeholder="combogrid" 
                                [value]="selectedPOL.value == null?'Please selected port of loading':selectedPOL.value">
                            <div class="dropdown-menu e--combogrid-content">
                                <div class="tabel-wrapper table-fixed">
                                    <div class="table-head-fixed">
                                        <div class="table-filter-block">
                                            <div class="search-field">
                                                <input class="form-control m-input m-input--square" type="text" placeholder="Search..." (keyup)="changePort($event.target.value, true)">
                                                <i class="icon-search"></i>
                                            </div>
                                        </div>
                                        <div class="table-header">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th class="col-xs-4">Port Code</th>
                                                        <th class="col-xs-4">Port Name</th>
                                                        <th class="col-xs-4">Country</th>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="table-body-scroll">
                                        <table class="table table-hover" *ngIf="portOfLadings">
                                            <tbody *ngFor="let pol of portOfLadings;let i = index;">
                                                <tr class="data-row" [ngClass]="{ 'data-selected': shipment.pol!==null && shipment.pol===pol.id }" data-id="{{i}}" 
                                                    (click)="shipment.pol = pol.id; selectedPOL.value= pol.nameEN">
                                                    <td class="col-xs-4">{{ pol.code }}</td>
                                                    <td class="col-xs-4">{{ pol.nameEN }}</td>
                                                    <td class="col-xs-4">{{ pol.countryName }}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-control-feedback" *ngIf="formAddEdit.submitted && shipment.pol == null" >
                            Port of loading is required
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="form-group">
                        <label class="form-control-label" for="">
                            Port of destination
                        </label>
                        <div class="dropdown e--combogrid" #selectedPOD>
                            <input class="form-control m-input m-input--square dropdown-toggle" type="text" readonly data-toggle="dropdown" placeholder="combogrid" 
                                [value]="selectedPOD.value == null?'Please selected port of loading':selectedPOD.value">
                            <div class="dropdown-menu e--combogrid-content">
                                <div class="tabel-wrapper table-fixed">
                                    <div class="table-head-fixed">
                                        <div class="table-filter-block">
                                            <div class="search-field">
                                                <input class="form-control m-input m-input--square" type="text" placeholder="Search..." (keyup)="changePort($event.target.value, false)">
                                                <i class="icon-search"></i>
                                            </div>
                                        </div>
                                        <div class="table-header">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th class="col-xs-4">Port Code</th>
                                                        <th class="col-xs-4">Port Name</th>
                                                        <th class="col-xs-4">Country</th>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="table-body-scroll">
                                        <table class="table table-hover" *ngIf="portOfDestinations">
                                            <tbody *ngFor="let pod of portOfDestinations;let i = index;">
                                                <tr class="data-row" [ngClass]="{ 'data-selected': shipment.pod!==null && shipment.pod===pod.id }" data-id="{{i}}" 
                                                    (click)="shipment.pod = pod.id; selectedPOD.value= pod.nameEN">
                                                    <td class="col-xs-4">{{ pod.code }}</td>
                                                    <td class="col-xs-4">{{ pod.nameEN }}</td>
                                                    <td class="col-xs-4">{{ pod.countryName }}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="form-group" [ngClass]="{ 'm-form__group has-danger': formAddEdit.submitted && shipment.paymentTerm == null }">
                        <label class="form-control-label" for="">
                            Term
                        </label>
                        <ng-select [allowClear]="true" [items]="terms" [disabled]="disabled" (data)="refreshValue($event)"
                            (selected)="shipment.paymentTerm = $event.id" (removed)="shipment.paymentTerm = null" (typed)="typed($event)"
                            placeholder="Select option">
                        </ng-select>
                        <div class="form-control-feedback" *ngIf="formAddEdit.submitted && shipment.paymentTerm == null" >
                            Term is required
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-4">
                    <div class="form-group">
                        <label class="form-control-label" for="">
                            Vessel name
                        </label>
                        <input type="text" class="form-control m-input m-input--square" placeholder="Enter text" autocomplete="nope"
                            (change)="shipment.flightVesselName = shipment.flightVesselName.trim()" [(ngModel)]="shipment.flightVesselName">
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="form-group">
                        <label class="form-control-label" for="">
                            Voy no
                        </label>
                        <input type="text" class="form-control m-input m-input--square" placeholder="Enter text" autocomplete="nope"
                            (change)="shipment.voyNo = shipment.voyNo.trim()" [(ngModel)]="shipment.voyNo">
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="form-group" [ngClass]="{ 'm-form__group has-danger': formAddEdit.submitted && shipment.shipmentType == null }">
                        <label class="form-control-label" for="">
                            Shipment type
                        </label>
                        <ng-select [allowClear]="true" [items]="shipmentTypes" [disabled]="disabled" (data)="refreshValue($event)"
                            (selected)="shipment.shipmentType = $event.id" (removed)="shipment.shipmentType = null" (typed)="typed($event)"
                            placeholder="Select option">
                        </ng-select>
                        <div class="form-control-feedback" *ngIf="formAddEdit.submitted && shipment.shipmentType == null" >
                            Shipment type is required
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-4">
                    <div class="form-group">
                        <label class="form-control-label" for="">
                            Purchase order(P/O) no 
                        </label>
                        <input type="text" class="form-control m-input m-input--square" placeholder="Enter text" autocomplete="nope"
                            (change)="shipment.pono = shipment.pono.trim()" [(ngModel)]="shipment.pono">
                    </div>
                    <div class="form-group">
                        <label class="form-control-label" for="">
                            Person in charge
                        </label>
                        <div class="dropdown e--combogrid" #selectedPersonInCharge>
                            <input class="form-control m-input m-input--square dropdown-toggle" type="text" readonly data-toggle="dropdown" placeholder="combogrid" 
                                [value]="selectedPersonInCharge.value == null?'Please selected person in charge':selectedPersonInCharge.value">
                            <div class="dropdown-menu e--combogrid-content">
                                <div class="tabel-wrapper table-fixed">
                                    <div class="table-head-fixed">
                                        <div class="table-filter-block">
                                            <div class="search-field">
                                                <input class="form-control m-input m-input--square" type="text" placeholder="Search..." (keyup)="changePort($event.target.value, false)">
                                                <i class="icon-search"></i>
                                            </div>
                                        </div>
                                        <div class="table-header">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th class="col-xs-4">User Name</th>
                                                        <th class="col-xs-4">Full Name</th>
                                                        <th class="col-xs-4">Role</th>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="table-body-scroll">
                                        <table class="table table-hover" *ngIf="userInCharges">
                                            <tbody *ngFor="let user of userInCharges;let i = index;">
                                                <tr class="data-row" [ngClass]="{ 'data-selected': shipment.personIncharge!==null && shipment.personIncharge===user.id }" data-id="{{i}}" 
                                                    (click)="shipment.personIncharge = user.id; selectedPersonInCharge.value= user.employeeNameVn">
                                                    <td class="col-xs-4">{{ user.username }}</td>
                                                    <td class="col-xs-4">{{ user.employeeNameVn }}</td>
                                                    <td class="col-xs-4">{{ user.employeeNameVn }}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="form-group">
                        <label class="form-control-label" for="" autocomplete="nope">
                            Note
                        </label>
                        <textarea class="form-control m-input--square" name="" id="" rows="5" (change)="shipment.notes = shipment.notes.trim()" [(ngModel)]="shipment.notes"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <!--end::Form-->
    </div>
</div>
<!--end:: m-portlet--> 
