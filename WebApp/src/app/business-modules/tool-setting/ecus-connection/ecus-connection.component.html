<!--begin:: subheader-->
<div class="m-subheader">
    <div class="d-flex align-items-center">
        <div class="mr-auto">
            <!--begin:: breadcrumbs-->
            <app-breadcrumb></app-breadcrumb>
            <!--end:: breadcrumbs-->
        </div>
        <div class="c-button-actions">
            <button type="button" class="btn btn-success m-btn--square m-btn--icon m-btn--uppercase" data-toggle="modal"
                data-target="#add-connection-modal">
                <span>
                    <i class="la la-plus"></i>
                    <span>
                        add new
                    </span>
                </span>
            </button>
            <button data-toggle="modal" type="" class="btn btn-danger m-btn--square m-btn--icon m-btn--uppercase">
                <span>
                    <i class="la la-upload"></i>
                    <span>
                        export
                    </span>
                </span>
            </button>
        </div>
    </div>
</div>
<!--end:: subheader-->
<!--begin::m-content-->
<div class="m-content">
    <!--begin:: m-portlet of search-form-->
    <div class="m-portlet">
        <div class="m-portlet__body">
            <!--begin::Form-->
            <div class="m-form">
                <div class="row">
                    <div class="col">
                        <div class="input-group m-input-group m-input-group--square">
                            <div class="input-group-prepend">
                                <button aria-expanded="false" aria-haspopup="true"
                                    class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" type="button"> All
                                </button>
                                <div class="dropdown-menu">
                                    <a class="dropdown-item active" href="javascript:void(0)" id="AllField"> All </a>
                                    <a class="dropdown-item" href="javascript:void(0)" id="NameField">
                                        Name </a>
                                    <a class="dropdown-item" href="javascript:void(0)" id="UserNameField"> User Name
                                    </a>
                                    <a class="dropdown-item" href="javascript:void(0)" id="ServerNameField"> Server Name
                                    </a>
                                    <a class="dropdown-item" href="javascript:void(0)" id="DatabaseNameField"> Database
                                        Name </a>
                                </div>
                            </div>
                            <input aria-label="" class="form-control" name="searchString" type="text">
                            <div class="input-group-append">
                                <button class="btn btn-primary" title="Search" type="button">
                                    <i class="la la-search"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-auto">
                        <button type="button" class="btn btn-default m-btn--square m-btn--icon m-btn--uppercase">
                            <span>
                                <i class="la la-refresh"></i>
                                <span>
                                    Reset
                                </span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>
            <!--end::Form-->
        </div>
    </div>
    <!--end::m-portlet of search-form-->

    <!--begin:: m-portlet-->
    <div class="m-portlet">
        <div class="m-portlet__body">
            <!--begin: Datatable -->
            <div class="table-wrapper" id="sea-lcl-export-table">
                <table class="table table-striped table-brand dataTable">
                    <thead>
                        <tr>
                            <th class="table-actions-col no-sorting"></th>
                            <th class="sorting">
                                <span>Name</span>
                            </th>
                            <th class="sorting">
                                <span>User name</span>
                            </th>
                            <th class="sorting">
                                <span>Full name</span>
                            </th>
                            <th class="sorting">
                                <span>Server name</span>
                            </th>
                            <th class="sorting">
                                <span>DB name</span>
                            </th>
                            <th class="sorting">
                                <span>Status</span>
                            </th>
                            <th class="sorting">
                                <span>Modified Date</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody class="tbody-group">
                        <tr *ngFor="let item of EcusConnections;let i = index;">
                            <td class="table-actions-col">
                                <div class="table-actions" style="width: 70px">
                                    <button type="button" (click)="getEcusConnectionDetails(item.id)"
                                        class="btn btn-success btn-sm m-btn--square m-btn--icon m-btn--icon-only"
                                        title="Edit" data-toggle="modal" data-target="#edit-connection-modal">
                                        <i class="la la-edit"></i>
                                    </button>
                                    <button type="button" (click)="idConnectToDelete=item.id;deleteConfirm()"
                                        class="btn btn-danger btn-sm m-btn--square m-btn--icon m-btn--icon-only"
                                        title="Remove" data-toggle="modal"
                                        data-target="#confirm-delete-connection-modal">
                                        <i class="la la-trash"></i>
                                    </button>
                                </div>
                            </td>
                            <td class="sorting">
                                <a href="javascript:void(0)" data-toggle="modal" (click)="getEcusConnectionDetails(item.id)"
                                    data-target="#edit-connection-modal">{{item.name}}</a>
                            </td>
                            <td class="sorting">
                                <span>{{item.username}}</span>
                            </td>
                            <td class="sorting">
                                <span>{{item.fullname}}</span>
                            </td>
                            <td class="sorting">
                                <span>{{item.serverName}}</span>
                            </td>
                            <td class="sorting">
                                <span>{{item.dbname}}</span>
                            </td>
                            <td class="sorting">
                                <span class="m--font-success" *ngIf="item.inactive===false">Active</span>
                                <span class="m--font" *ngIf="item.inactive===true">Inactive</span>
                            </td>
                            <td>
                                <span>{{item.datetimeCreated | date:'dd/MM/yyyy'}}</span>
                            </td>
                        </tr>

                    </tbody>
                </table>
            </div>
            <!--end: Datatable -->

            <!--begin::pagination-->
            <app-pagination *ngIf="pager.totalItems>0" [config]="pager" (pagerObject)="setPage($event)">
            </app-pagination>
            <!--end::pagination-->
        </div>
    </div>
    <!--end:: m-portlet-->
</div>
<!--end::m-content-->

<!--begin::add-connection-modal-->
<form novalidate #addEcusConnectForm="ngForm" name="addEcusConnectForm" (ngSubmit)="addEcusConnectForm.form.valid">
    <div class="modal fade" id="add-connection-modal" data-backdrop="static" role="dialog" aria-labelledby=""
        aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Connection</h5>
                    <button id="closeButton" (click)="closeModal(addEcusConnectForm)" type="button" class="close"
                        aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" *ngIf="isDisplay">
                    <div class="m-form m-form m-form--state">
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addEcusConnectForm.submitted && ecusName.invalid}">
                                    <label class="form-control-label" for="">
                                        name <span class="m--font-danger">(*)</span>
                                    </label>
                                    <input ecusSpecicalCharacterAllowSpace
                                        (change)="EcusConnectionAdd.name=EcusConnectionAdd.name.trim()" required
                                        [(ngModel)]="EcusConnectionAdd.name" type="text" #ecusName="ngModel"
                                        class="form-control m-input m-input--square" autocomplete="nope" name="ecusName"
                                        maxlength="250" placeholder="">
                                    <div class="form-control-feedback"
                                        *ngIf="addEcusConnectForm.submitted && ecusName.invalid">
                                        Name is required
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-6">
                                <div class="form-group"
                                    [ngClass]="{ 'm-form__group has-danger': addEcusConnectForm.submitted && EcusConnectionAdd.userId===null}">
                                    <label class="form-control-label" for="">
                                        user name <span class="m--font-danger">(*)</span>
                                    </label>
                                    <!-- <input type="text" class="form-control m-input m-input--square" autocomplete="nope" name="" placeholder=""> -->
                                    <ng-select [allowClear]="true" [items]="Users" [disabled]="disabled"
                                        (selected)="EcusConnectionAdd.userId=$event.id;EcusConnectionAdd.username=$event.text"
                                        (removed)="EcusConnectionAdd.userId=null" (typed)="typed($event)"
                                        placeholder="Select filter">
                                    </ng-select>
                                    <div class="form-control-feedback"
                                        *ngIf="addEcusConnectForm.submitted && EcusConnectionAdd.userId===null">
                                        Username is required
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        server name
                                    </label>
                                    <input ecusSpecicalCharacterNoSpace [(ngModel)]="EcusConnectionAdd.serverName"
                                        type="text" class="form-control m-input m-input--square" autocomplete="nope"
                                        name="ecusServerName" placeholder="">
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        database name
                                    </label>
                                    <input ecusSpecicalCharacterNoSpace [(ngModel)]="EcusConnectionAdd.dbname"
                                        type="text" class="form-control m-input m-input--square" autocomplete="nope"
                                        name="ecusDBName" placeholder="">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        database user name
                                    </label>
                                    <input ecusSpecicalCharacterNoSpace [(ngModel)]="EcusConnectionAdd.dbusername"
                                        type="text" class="form-control m-input m-input--square" autocomplete="nope"
                                        name="ecusDBUserName" placeholder="">
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        database password
                                    </label>
                                    <input [(ngModel)]="EcusConnectionAdd.dbpassword" type="text"
                                        (change)="EcusConnectionAdd.dbpassword=EcusConnectionAdd.dbpassword.trim()"
                                        class="form-control m-input m-input--square" autocomplete="nope"
                                        name="ecusDBPass" placeholder="">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        status
                                    </label>
                                    <div>
                                        <label class="m-checkbox">
                                            <input type="checkbox" name="ecusStatus"
                                                [checked]="EcusConnectionAdd.inactive"
                                                (change)="EcusConnectionAdd.inactive=!EcusConnectionAdd.inactive">
                                            <!-- Active -->
                                            <span></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="form-control-label" for="">
                                        Note
                                    </label>
                                    <input [(ngModel)]="EcusConnectionAdd.note"
                                        (change)="EcusConnectionAdd.note=EcusConnectionAdd.note.trim()" type="text"
                                        class="form-control m-input m-input--square" autocomplete="nope" name="ecusNote"
                                        placeholder="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer m--align-center c-button-actions">
                    <button type="submit" class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase"
                        (click)="SubmitNewConnect(addEcusConnectForm)">
                        <span>
                            <i class="la la-save"></i>
                            <span>
                                Save
                            </span>
                        </span>
                    </button>
                    <button (click)="closeModal(addEcusConnectForm)" type="button"
                        class="btn m-btn--square m-btn--icon m-btn--uppercase">
                        <span>
                            <i class="la la-ban"></i>
                            <span>
                                cancel
                            </span>
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>
<!--end::add-connection-modal-->

<!--begin::edit-ware-house-modall-->
<form novalidate #editEcusConnectForm="ngForm" name="editEcusConnectForm" (ngSubmit)="editEcusConnectForm.form.valid">
    <div class="modal fade" id="edit-connection-modal" data-backdrop="static" role="dialog" aria-labelledby=""
        aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                
                    <div class="modal-header">
                        <h5 class="modal-title">Detail/Edit Connection</h5>
                        <button type="button" class="close" (click)="closeModal(editEcusConnectForm)"
                            aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body" *ngIf="EcusConnectionEdit!==null">
                        <div class="m-form m-form m-form--state">
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group"
                                        [ngClass]="{ 'm-form__group has-danger': editEcusConnectForm.submitted && edtEcusName.invalid}">
                                        <label class="form-control-label" for="">
                                            name <span class="m--font-danger">(*)</span>
                                        </label>
                                        <input ecusSpecicalCharacterAllowSpace type="text" 
                                            (change)="EcusConnectionEdit.name=EcusConnectionEdit.name.trim()" required
                                            class="form-control m-input m-input--square" #edtEcusName="ngModel"
                                            [(ngModel)]="EcusConnectionEdit.name" autocomplete="nope" name="edtEcusName"
                                            placeholder="">
                                        <div class="form-control-feedback"
                                            *ngIf="editEcusConnectForm.submitted && edtEcusName.invalid">
                                            Name is required
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group"
                                        [ngClass]="{ 'm-form__group has-danger': editEcusConnectForm.submitted && EcusConnectionEdit.userId===null}">
                                        <label class="form-control-label" for="">
                                            user name <span class="m--font-danger">(*)</span>
                                        </label>
                                        <ng-select [allowClear]="true" [items]="Users" [disabled]="disabled"
                                            [active]="[{id:EcusConnectionEdit.userId,text:EcusConnectionEdit.username}]"
                                            (selected)="EcusConnectionEdit.userId=$event.id;EcusConnectionEdit.username=$event.text"
                                            (removed)="EcusConnectionEdit.userId=null" (typed)="typed($event)"
                                            placeholder="Select filter">
                                        </ng-select>
                                        <div class="form-control-feedback"
                                            *ngIf="editEcusConnectForm.submitted && EcusConnectionEdit.userId===null">
                                            Username is required
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label class="form-control-label" for="">
                                            server name
                                        </label>
                                        <input ecusSpecicalCharacterNoSpace [(ngModel)]="EcusConnectionEdit.serverName"
                                            type="text" class="form-control m-input m-input--square" autocomplete="nope"
                                            name="edtEcusServerName" placeholder="">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label class="form-control-label" for="">
                                            database name
                                        </label>
                                        <input ecusSpecicalCharacterNoSpace [(ngModel)]="EcusConnectionEdit.dbname"
                                            type="text" class="form-control m-input m-input--square" autocomplete="nope"
                                            name="edtEcusDBName" placeholder="">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label class="form-control-label" for="">
                                            database user name
                                        </label>
                                        <input ecusSpecicalCharacterNoSpace [(ngModel)]="EcusConnectionEdit.dbusername"
                                            type="text" class="form-control m-input m-input--square" autocomplete="nope"
                                            name="edtEcusDBUserName" placeholder="">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label class="form-control-label" for="">
                                            database password
                                        </label>
                                        <input [(ngModel)]="EcusConnectionEdit.dbpassword"
                                            (change)="EcusConnectionEdit.dbpassword=EcusConnectionEdit.dbpassword.trim()"
                                            type="text" class="form-control m-input m-input--square" autocomplete="nope"
                                            name="edtEcusDBPass" placeholder="">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label class="form-control-label" for="">
                                            status
                                        </label>
                                        <div>
                                            <label class="m-checkbox">
                                                <input type="checkbox" [checked]="EcusConnectionEdit.inactive"
                                                    name="edtEcusStatus"
                                                    (change)="EcusConnectionEdit.inactive=!EcusConnectionEdit.inactive">
                                                <!-- Active -->
                                                <span></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label class="form-control-label" for="">
                                            Note
                                        </label>
                                        <input [(ngModel)]="EcusConnectionEdit.note"
                                            (change)="EcusConnectionEdit.note=EcusConnectionEdit.note.trim()"
                                            type="text" class="form-control m-input m-input--square" autocomplete="nope"
                                            name="edtEcusNote" placeholder="">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 m--margin-top-10 m--margin-bottom-5">
                                    <span class="m--font-bolder">Create:</span>
                                    <span
                                        class="m--font-brand m--margin-left-5">{{EcusConnectionEdit.datetimeCreated | date:'dd/MM/yyyy h:mm:ss a'}}</span>
                                    <span class="m--font-bolder m--margin-left-5">by</span>
                                    <span
                                        class="m--font-brand m--margin-left-5">{{EcusConnectionEdit.userCreatedName}}</span>
                                </div>
                                <div class="col-md-6 m--margin-top-10 m--margin-bottom-5">
                                    <span class="m--font-bolder">Modified:</span>
                                    <ng-container *ngIf="EcusConnectionEdit.userModified!==null">
                                        <span
                                            class="m--font-brand m--margin-left-5">{{EcusConnectionEdit.datetimeModified | date:'dd/MM/yyyy h:mm:ss a'}}</span>
                                        <span class="m--font-bolder m--margin-left-5">by</span>
                                        <span
                                            class="m--font-brand m--margin-left-5">{{EcusConnectionEdit.userModifiedName}}</span>
                                    </ng-container>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer m--align-center c-button-actions">
                        <button type="submit" class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase"
                        (click)="SubmitEditConnect(editEcusConnectForm)">
                            <span>
                                <i class="la la-save"></i>
                                <span>
                                    edit
                                </span>
                            </span>
                        </button>
                        <button type="button" class="btn m-btn--square m-btn--icon m-btn--uppercase"
                            (click)="closeModal(editEcusConnectForm)">
                            <span>
                                <i class="la la-ban"></i>
                                <span>
                                    cancel
                                </span>
                            </span>
                        </button>
                    </div>
              
            </div>
        </div>
    </div>
</form>

<!--end::edit-ware-house-modal-->

<!--begin::confirm-delete-modal-->
<div class="modal fade" id="confirm-delete-connection-modal" data-backdrop="static" role="dialog" aria-labelledby=""
    aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Notification</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirm-text-block">
                    <span>Do you want to delete <span class="m--font-bold">Connection Name</span>item?</span>
                </div>
            </div>
            <div class="modal-footer m--align-center c-button-actions">
                <button type="button" (click)="deleteConfirm(true)" class="btn btn-brand m-btn--square m-btn--icon m-btn--uppercase">
                    <span>
                        <i class="la la-save"></i>
                        <span>
                            Ok
                        </span>
                    </span>
                </button>
                <button type="button" class="btn m-btn--square m-btn--icon m-btn--uppercase" data-dismiss="modal">
                    <span>
                        <i class="la la-ban"></i>
                        <span>
                            cancel
                        </span>
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>
<!--end::confirm-delete-modal-->